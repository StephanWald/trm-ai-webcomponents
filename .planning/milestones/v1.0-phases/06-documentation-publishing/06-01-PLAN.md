---
phase: 06-documentation-publishing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - stencil.config.ts
  - src/components/sp-org-chart/sp-org-chart.css
  - src/components/sp-walkthrough/sp-walkthrough.css
  - src/components/sp-markdown-editor/sp-markdown-editor.css
  - src/components/sp-markdown-editor/sp-markdown-editor.tsx
  - src/components/sp-walkthrough/sp-walkthrough.tsx
autonomous: true
requirements:
  - DOCS-02

must_haves:
  truths:
    - "Running stencil build generates a docs.json file at the repo root containing all component API metadata"
    - "docs.json contains non-empty styles arrays for all three components (sp-org-chart, sp-walkthrough, sp-markdown-editor) documenting --dwc-* CSS custom properties"
    - "docs.json contains non-empty parts arrays for sp-org-chart and sp-markdown-editor"
  artifacts:
    - path: "docs.json"
      provides: "Auto-generated component API documentation JSON"
      contains: "components"
    - path: "stencil.config.ts"
      provides: "docs-json output target configuration"
      contains: "docs-json"
    - path: "src/components/sp-org-chart/sp-org-chart.css"
      provides: "CSS @prop JSDoc annotations for org-chart DWC tokens"
      contains: "@prop --dwc-"
    - path: "src/components/sp-walkthrough/sp-walkthrough.css"
      provides: "CSS @prop JSDoc annotations for walkthrough DWC tokens"
      contains: "@prop --dwc-"
    - path: "src/components/sp-markdown-editor/sp-markdown-editor.css"
      provides: "CSS @prop JSDoc annotations for markdown-editor DWC tokens"
      contains: "@prop --dwc-"
  key_links:
    - from: "stencil.config.ts"
      to: "docs.json"
      via: "docs-json output target"
      pattern: "type.*docs-json"
    - from: "src/components/*/sp-*.css"
      to: "docs.json styles array"
      via: "CSS @prop JSDoc annotations"
      pattern: "@prop --dwc-"
---

<objective>
Add Stencil docs-json output target and annotate all component CSS/TSX files with JSDoc documentation tags so that `stencil build` generates a complete `docs.json` file containing props, events, methods, CSS custom properties, and CSS parts for all components.

Purpose: docs.json is the foundation for auto-generated API reference pages in the Docusaurus site (DOCS-02). Without CSS @prop annotations and @part JSDoc tags, the generated JSON will have empty styles/parts arrays.

Output: `docs.json` at repo root with complete API metadata for all three components + sp-example.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-documentation-publishing/06-RESEARCH.md
@stencil.config.ts
@src/components/sp-org-chart/sp-org-chart.css
@src/components/sp-walkthrough/sp-walkthrough.css
@src/components/sp-markdown-editor/sp-markdown-editor.css
@src/components/sp-org-chart/sp-org-chart.tsx
@src/components/sp-walkthrough/sp-walkthrough.tsx
@src/components/sp-markdown-editor/sp-markdown-editor.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add docs-json output target and CSS @prop annotations</name>
  <files>
    stencil.config.ts
    src/components/sp-org-chart/sp-org-chart.css
    src/components/sp-walkthrough/sp-walkthrough.css
    src/components/sp-markdown-editor/sp-markdown-editor.css
  </files>
  <action>
    1. Add a `docs-json` output target to `stencil.config.ts` alongside the existing output targets:
       ```typescript
       {
         type: 'docs-json',
         file: 'docs.json',
       }
       ```

    2. For each component CSS file, add `@prop` JSDoc annotations inside a comment block within the `:host` selector. Scan the CSS file for every `var(--dwc-*)` usage and create a `@prop` entry for each unique token. Format:
       ```css
       :host {
         /**
          * @prop --dwc-color-primary: Description of what this token controls
          * @prop --dwc-color-surface: Description
          */
       }
       ```

    3. **sp-org-chart.css**: Document all `--dwc-*` tokens used (approximately 10-15 tokens covering colors, spacing, typography, borders, shadows).

    4. **sp-walkthrough.css**: Document all `--dwc-*` tokens used (approximately 15-20 tokens covering panel colors, overlay colors, controls, author mode).

    5. **sp-markdown-editor.css**: Document all `--dwc-*` tokens used (approximately 15-20 tokens covering editor colors, toolbar, footer, modes).

    For each token, write a brief, useful description based on HOW the token is used in the CSS (e.g., "Background color for user tiles" not just "Primary color"). Read each CSS file to understand the actual usage context.
  </action>
  <verify>
    Run `npm run build` and verify:
    - `docs.json` file is created at repo root
    - `cat docs.json | node -e "const d=JSON.parse(require('fs').readFileSync('/dev/stdin','utf8')); d.components.forEach(c => console.log(c.tag, 'styles:', c.styles.length, 'parts:', c.parts.length))"` shows non-zero styles counts for all 3 components
  </verify>
  <done>
    stencil.config.ts has docs-json output target; all three component CSS files have @prop JSDoc annotations; `npm run build` generates docs.json with populated styles arrays for each component.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add @part JSDoc annotations to sp-markdown-editor and sp-walkthrough</name>
  <files>
    src/components/sp-markdown-editor/sp-markdown-editor.tsx
    src/components/sp-walkthrough/sp-walkthrough.tsx
  </files>
  <action>
    sp-org-chart already has @part annotations. The other two components need them added to the component-level JSDoc block on the @Component decorator.

    1. **sp-markdown-editor.tsx**: Add @part JSDoc tags for all elements that have `part="..."` attributes in the render method. Based on the codebase grep, these are:
       - `@part toolbar` - The formatting toolbar
       - `@part source-editor` - The source mode textarea
       - `@part wysiwyg-editor` - The WYSIWYG preview container
       - `@part mode-switcher` - The mode switching tabs
       - `@part footer` - The character/word count footer

       Add these to the existing (or create a new) JSDoc block above `@Component({ tag: 'sp-markdown-editor', ... })`.

    2. **sp-walkthrough.tsx**: Check the render method for any elements with `part="..."` attributes. If none exist (walkthrough may not expose parts), note that in the component JSDoc as a deliberate design choice. If any exist, document them with @part tags.

    Preserve all existing JSDoc content. Only ADD @part lines â€” do not remove or modify existing documentation.
  </action>
  <verify>
    Run `npm run build` and verify:
    - `cat docs.json | node -e "const d=JSON.parse(require('fs').readFileSync('/dev/stdin','utf8')); d.components.filter(c=>c.tag==='sp-markdown-editor').forEach(c => console.log(c.tag, 'parts:', c.parts.length, c.parts.map(p=>p.name)))"` shows 5 parts
    - Run `npm test` to ensure no existing tests are broken by the JSDoc changes
  </verify>
  <done>
    sp-markdown-editor.tsx has @part JSDoc tags for all 5 exposed parts; sp-walkthrough.tsx has @part annotations if applicable; docs.json parts arrays are populated correctly; all existing tests still pass.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `docs.json` exists at repo root
3. `docs.json` contains entries for all 4 components (sp-example, sp-org-chart, sp-walkthrough, sp-markdown-editor)
4. Each of the 3 main components has non-empty `styles` array in docs.json
5. sp-org-chart and sp-markdown-editor have non-empty `parts` array in docs.json
6. `npm test` passes (no regressions from JSDoc changes)
</verification>

<success_criteria>
- docs.json generated by stencil build with complete component API metadata
- All --dwc-* CSS custom properties documented via @prop annotations
- All ::part() selectors documented via @part JSDoc tags
- No test regressions
</success_criteria>

<output>
After completion, create `.planning/phases/06-documentation-publishing/06-01-SUMMARY.md`
</output>
