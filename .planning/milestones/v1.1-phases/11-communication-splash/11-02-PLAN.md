---
phase: 11-communication-splash
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/sp-splash/types.ts
  - src/components/sp-splash/sp-splash.tsx
  - src/components/sp-splash/sp-splash.css
  - src/index.html
autonomous: true
requirements: [SPLS-01, SPLS-02, SPLS-03, SPLS-04, SPLS-05, SPLS-06]

must_haves:
  truths:
    - "sp-splash renders a full-screen modal overlay with backdrop blur"
    - "Splash displays a gradient header, content area, and footer"
    - "Close button, Escape key, and backdrop click all dismiss the splash"
    - "Show and hide methods control visibility with fade/slide animations"
    - "Component emits a close event when dismissed"
    - "Content is customizable via named slots (logo, title, subtitle, body, footer)"
  artifacts:
    - path: "src/components/sp-splash/types.ts"
      provides: "SplashCloseEventDetail interface"
    - path: "src/components/sp-splash/sp-splash.tsx"
      provides: "SpSplash Stencil component with slots, methods, dismiss behaviors, and animation"
    - path: "src/components/sp-splash/sp-splash.css"
      provides: "Full-screen overlay CSS with backdrop blur, gradient header, fade/slide animations, DWC theming"
  key_links:
    - from: "src/components/sp-splash/sp-splash.tsx"
      to: "document"
      via: "keydown listener for Escape dismiss"
      pattern: "addEventListener.*keydown"
    - from: "src/components/sp-splash/sp-splash.tsx"
      to: "host element"
      via: "show/hide @Method() controlling open state"
      pattern: "@Method.*async show|@Method.*async hide"
---

<objective>
Build sp-splash as a full-screen modal overlay with backdrop blur, gradient header, named slots for all content areas, multiple dismiss mechanisms, and fade/slide animations.

Purpose: Provide a reusable splash/welcome screen component that can display branding, onboarding content, or announcements in a full-screen overlay with smooth animations and flexible content composition via slots.

Output: One Stencil component (sp-splash) with types, CSS, and demo section in index.html.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Pattern reference for component structure, DWC theming, and event patterns
@src/components/sp-popover/sp-popover.tsx
@src/components/sp-popover/sp-popover.css
@src/components/sp-example/sp-example.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create types and sp-splash component with slots, methods, and dismiss behaviors</name>
  <files>
    src/components/sp-splash/types.ts
    src/components/sp-splash/sp-splash.tsx
  </files>
  <action>
**types.ts** — Define:
- `SplashCloseEventDetail` interface: `{ reason: 'button' | 'escape' | 'backdrop'; }` — indicates how the splash was dismissed (SPLS-05)

**sp-splash.tsx** — Stencil component with shadow: true, tag: 'sp-splash':

Props:
- `open: boolean` — mutable, reflect: true, defaults to false. Controls visibility. (SPLS-04)
- `closeOnEscape: boolean` — defaults to true. Whether Escape key dismisses. (SPLS-03)
- `closeOnBackdrop: boolean` — defaults to true. Whether backdrop click dismisses. (SPLS-03)
- `theme: 'light' | 'dark' | 'auto'` — defaults to 'auto'. Theme override.

State:
- `isVisible: boolean` — internal visibility state driving CSS classes

Events:
- `splashClose: EventEmitter<SplashCloseEventDetail>` — emitted when dismissed by any mechanism (SPLS-05)

Methods (async per Stencil requirement):
- `show(): Promise<void>` — sets open = true (SPLS-04)
- `hide(): Promise<void>` — sets open = false (SPLS-04)

@Watch('open'):
- When open becomes true: set isVisible = true, attach keydown listener for Escape
- When open becomes false: set isVisible = false, detach keydown listener

componentDidLoad():
- If open is initially true, sync isVisible and attach listeners (Stencil @Watch does not fire for initial values)

disconnectedCallback():
- Detach keydown listener to prevent memory leaks

Private handlers (arrow function class properties):
- `handleKeydown = (event: KeyboardEvent)` — if event.key === 'Escape' && this.closeOnEscape, call dismiss('escape')
- `handleBackdropClick = (event: MouseEvent)` — if closeOnBackdrop and click target is the backdrop overlay itself (not a child), call dismiss('backdrop')
- `handleCloseClick = ()` — call dismiss('button')
- `dismiss(reason: 'button' | 'escape' | 'backdrop')` — set open = false, emit splashClose with reason

Render structure (SPLS-02, SPLS-06):
```
<Host class={hostClass}>
  <div class={{ 'splash-overlay': true, open: this.isVisible }}
       part="overlay"
       onClick={this.handleBackdropClick}
       role="dialog"
       aria-modal="true"
       aria-hidden={(!this.isVisible).toString()}>
    <div class="splash-container" part="container">
      <button class="close-button" part="close-button"
              onClick={this.handleCloseClick}
              aria-label="Close">
        {/* Tabler X icon */}
        <svg ...>
          <line x1="18" y1="6" x2="6" y2="18" />
          <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
      </button>
      <header class="splash-header" part="header">
        <div class="splash-logo"><slot name="logo" /></div>
        <div class="splash-title"><slot name="title" /></div>
        <div class="splash-subtitle"><slot name="subtitle" /></div>
      </header>
      <div class="splash-body" part="body">
        <slot name="body" />
      </div>
      <footer class="splash-footer" part="footer">
        <slot name="footer" />
      </footer>
    </div>
  </div>
</Host>
```

The close button (top-right) uses a Tabler X icon rendered inline (same SVG pattern as other components — currentColor stroke, aria-hidden). No need for a separate icon helper since it's the only icon.

Important: The handleBackdropClick must check that the click target is the overlay div itself, not a child. Use `if (event.target === event.currentTarget)` to prevent dismissing when clicking inside the container content.
  </action>
  <verify>Run `npx stencil build` — no TypeScript errors. Verify types.ts and sp-splash.tsx exist with correct exports.</verify>
  <done>sp-splash component renders full-screen overlay with backdrop, container with close button, header/body/footer slot areas. Show/hide methods toggle visibility. Escape, backdrop click, and close button all dismiss with correct event detail. Build passes.</done>
</task>

<task type="auto">
  <name>Task 2: Create CSS with backdrop blur, gradient header, fade/slide animations, and DWC theming; add demo to index.html</name>
  <files>
    src/components/sp-splash/sp-splash.css
    src/index.html
  </files>
  <action>
**sp-splash.css** — Full-screen overlay with animations and DWC theming:

Host:
- `:host { display: contents; }` — splash doesn't take up layout space when closed

Overlay (.splash-overlay):
- position: fixed, inset: 0, z-index: 10000
- display: flex, align-items: center, justify-content: center
- background: rgba(0, 0, 0, 0.5), backdrop-filter: blur(4px) (SPLS-01)
- opacity: 0, visibility: hidden, transition: opacity 0.3s ease, visibility 0.3s ease
- When .open: opacity: 1, visibility: visible

Container (.splash-container):
- background: var(--dwc-color-surface, #fff)
- border-radius: var(--dwc-border-radius-lg, 12px)
- box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3)
- max-width: 480px, width: 90vw
- max-height: 90vh, overflow-y: auto
- position: relative (for close button positioning)
- transform: translateY(20px), transition: transform 0.3s ease (SPLS-04 slide animation)
- When parent .open: transform: translateY(0)

Close button (.close-button):
- position: absolute, top: 12px, right: 12px (SPLS-03)
- Background: transparent, border: none, cursor: pointer
- width: 32px, height: 32px, display: flex, align-items: center, justify-content: center
- border-radius: 50%, color: var(--dwc-color-text-secondary, #888)
- Hover: background: var(--dwc-color-surface-secondary, #f5f5f5), color: var(--dwc-color-text, #1a1a1a)

Header (.splash-header):
- padding: 2rem 2rem 1rem
- background: linear-gradient(135deg, var(--dwc-color-primary, #1976d2) 0%, var(--dwc-color-primary-dark, #1565c0) 100%) (SPLS-02 gradient header)
- border-radius: var(--dwc-border-radius-lg, 12px) var(--dwc-border-radius-lg, 12px) 0 0
- color: #fff, text-align: center

Logo (.splash-logo): margin-bottom: 0.75rem
Title (.splash-title): font-size: 1.5rem, font-weight: 700, margin-bottom: 0.25rem
Subtitle (.splash-subtitle): font-size: 0.875rem, opacity: 0.85

Body (.splash-body):
- padding: 1.5rem 2rem
- font-family: var(--dwc-font-family, system-ui, sans-serif)
- color: var(--dwc-color-text, #1a1a1a)
- font-size: var(--dwc-font-size-sm, 0.875rem)
- line-height: 1.6

Footer (.splash-footer):
- padding: 1rem 2rem 1.5rem
- border-top: 1px solid var(--dwc-color-border, #e0e0e0)
- text-align: center

Theme overrides:
- :host(.theme-light) — explicit light colors
- :host(.theme-dark) — dark surface (#1e1e1e), dark border, white text, adjusted gradient (darker primary tones), close button hover on dark bg

**src/index.html** — Add a demo section after the Voice Input Button section (before the Communication Preferences section if plan 01 ran first, or before OrgChart). Use this structure:
- Section heading "Splash Screen"
- Description paragraph
- Three buttons: "Show Splash", "Show Splash (Dark)", "Show Splash (Programmatic)"
- sp-splash element with id="splashDemo", containing slotted content:
  - slot="logo": an emoji or simple SVG placeholder (e.g., a div with a large icon)
  - slot="title": "Welcome to Skillspilot"
  - slot="subtitle": "Your AI-powered learning companion"
  - slot="body": A paragraph of welcome text
  - slot="footer": A "Get Started" button
- sp-splash element with id="splashDemoDark" theme="dark" with similar slotted content
- Event log div (id="splashEventLog")
- Script: wire button clicks to splash.show(), wire splashClose event to log the reason

NOTE on index.html: Since Plan 01 may add its own demo section, add the splash demo section AFTER the OrgChart section and BEFORE the Walkthrough section. This avoids merge conflicts with Plan 01's changes. Use these element IDs for E2E tests: splashDemo, splashDemoDark.
  </action>
  <verify>Run `npx stencil build` — build passes. Open http://localhost:3333, click "Show Splash" button — full-screen overlay appears with gradient header, slotted content, and close button. Click close/backdrop/press Escape — splash dismisses with animation.</verify>
  <done>sp-splash renders full-screen modal with backdrop blur, gradient header, fade/slide-in animation on open, fade/slide-out on close. Close button (top-right), Escape key, and backdrop click all dismiss. Named slots (logo, title, subtitle, body, footer) render custom content. DWC theming with light/dark overrides. All SPLS-01 through SPLS-06 requirements satisfied.</done>
</task>

</tasks>

<verification>
1. `npx stencil build` passes with no errors
2. docs.json contains sp-splash with correct props, events, methods, and slots
3. Splash opens as a full-screen centered overlay with backdrop blur
4. Gradient header renders above the content body and footer
5. Close button (top-right), Escape key, and backdrop click all dismiss the splash
6. splashClose event fires with correct reason ('button', 'escape', 'backdrop')
7. show() and hide() methods work programmatically
8. Named slots (logo, title, subtitle, body, footer) accept and render custom content
9. Fade + slide animation on open and close
10. Dark theme variant renders correctly
</verification>

<success_criteria>
- Full-screen modal overlay with backdrop blur renders correctly (SPLS-01)
- Gradient header, content area, and footer are visible (SPLS-02)
- Close button, Escape, and backdrop click all dismiss (SPLS-03)
- show/hide methods work with fade/slide animations (SPLS-04)
- splashClose event emits with dismiss reason (SPLS-05)
- All 5 named slots render custom content (SPLS-06)
- Build passes cleanly with no TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/11-communication-splash/11-02-SUMMARY.md`
</output>
