---
phase: 12-docs-tests
plan: 03
type: execute
wave: 2
depends_on:
  - 12-01
  - 12-02
files_modified:
  - docs.json
autonomous: true
requirements:
  - DOCS-03

must_haves:
  truths:
    - "npm run build succeeds (docs.json regenerated with current component APIs)"
    - "Stencil spec tests pass with 70% coverage threshold across statements, branches, functions, and lines"
    - "Stencil E2E tests pass for all components"
    - "Docusaurus docs site builds without errors"
  artifacts:
    - path: "docs.json"
      provides: "Up-to-date component API documentation data"
  key_links:
    - from: "docs.json"
      to: "docs/docs/components/*.mdx"
      via: "ApiReference component reads docs.json for prop/event/method tables"
      pattern: "docsData.components.find"
---

<objective>
Verify that all v1.1 components meet the 70% test coverage threshold, regenerate docs.json, and confirm the full docs site builds successfully.

Purpose: DOCS-03 requires all new and refactored v1.1 components to have Stencil spec and E2E tests meeting the 70% coverage threshold. The tests were written in phases 7-11 and the coverage threshold is already enforced in stencil.config.ts. This plan verifies everything works end-to-end: build, test, coverage, and docs site.

Output: Verified passing test suite, regenerated docs.json, successful docs site build
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@stencil.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run full build, test suite with coverage, and E2E tests</name>
  <files>
    docs.json
  </files>
  <action>
Execute the full verification sequence:

1. Run `npm run build` to regenerate docs.json and dist/ outputs. This ensures docs.json reflects any JSDoc changes made in plans 01-02 context files. The build also validates that all components compile without errors.

2. Run `npx stencil test --spec --coverage` to execute all spec tests with coverage reporting. Verify that the global 70% threshold (configured in stencil.config.ts coverageThreshold) passes. If any component is below 70%, identify the gap and add targeted spec tests to bring it above threshold.

3. Run `npx stencil test --e2e` to execute all E2E tests. All must pass.

4. If docs.json was regenerated with changes (check `git diff docs.json`), stage and include it. The docs site depends on docs.json being up to date.

Coverage verification checklist â€” confirm each v1.1 component directory meets 70% statements:
- sp-org-chart (Phase 7 refactored)
- sp-walkthrough (Phase 8 refactored)
- sp-popover (Phase 9 new)
- sp-language-selector + sp-language-list (Phase 10 new)
- sp-voice-input-button (Phase 10 new)
- sp-communication-preferences + sp-communication-list (Phase 11 new)
- sp-splash (Phase 11 new)
  </action>
  <verify>
`npm run build` exits 0. `npx stencil test --spec --coverage` exits 0 with all components above 70%. `npx stencil test --e2e` exits 0. docs.json exists and is up to date.
  </verify>
  <done>
Full Stencil build succeeds. All spec tests pass with 70%+ coverage. All E2E tests pass. docs.json is current.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify docs site builds with all pages</name>
  <files>
    docs.json
  </files>
  <action>
1. Run `cd docs && npx docusaurus build` to build the full Docusaurus site.

2. Verify build output includes all 8 component pages:
   - components/sp-org-chart
   - components/sp-walkthrough
   - components/sp-markdown-editor
   - components/sp-popover
   - components/sp-language-selector
   - components/sp-voice-input-button
   - components/sp-communication-preferences
   - components/sp-splash

3. Check build output for any warnings about broken links or missing references. Fix any issues found.

4. Verify sidebar navigation includes all 8 components by checking the built output or build logs.

If the docs site build fails due to MDX syntax errors or broken references, fix the offending MDX files (from plans 01 and 02) and re-run the build.
  </action>
  <verify>
`cd docs && npx docusaurus build` exits 0 with no broken link warnings. Build output directory contains all 8 component pages.
  </verify>
  <done>
Docusaurus site builds successfully with all 8 component pages, no broken links, no warnings. Full documentation is ready for deployment.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` exits 0
2. `npx stencil test --spec --coverage` exits 0, all components above 70% threshold
3. `npx stencil test --e2e` exits 0
4. `cd docs && npx docusaurus build` exits 0, no broken links
5. docs.json is up to date with all 11 component entries
</verification>

<success_criteria>
Full build, test, coverage, and docs site build all pass. The 70% coverage threshold is met for all v1.1 components. The docs site includes all 8 component reference pages.
</success_criteria>

<output>
After completion, create `.planning/phases/12-docs-tests/12-03-SUMMARY.md`
</output>
