/**
 * sp-org-chart component styles
 * Vertical indented list layout with DWC token theming and fallback defaults.
 * Every var() call has a fallback default â€” no bare var(--dwc-*) calls.
 */

:host {
  /**
   * @prop --dwc-font-family: Base font family for all text in the org chart
   * @prop --dwc-font-size-base: Base font size for names and body text
   * @prop --dwc-font-size-sm: Small font size for role labels and secondary text
   * @prop --dwc-font-size-xs: Extra-small font size for branch badge
   * @prop --dwc-font-size-lg: Large font size for avatar initials and empty-state message
   * @prop --dwc-font-size-xl: Extra-large font size for drop zone icons
   * @prop --dwc-font-weight-semibold: Semibold weight for user names
   * @prop --dwc-font-weight-medium: Medium weight for labels and badges
   * @prop --dwc-line-height-normal: Normal line height for body text
   * @prop --dwc-color-surface: Background color for user tiles and drop zones
   * @prop --dwc-color-surface-alt: Alternate surface for branch tiles
   * @prop --dwc-color-border: Border color for tiles, children connector, and drop zones
   * @prop --dwc-color-text: Primary text color for user names
   * @prop --dwc-color-text-secondary: Secondary text color for role/email/phone labels
   * @prop --dwc-color-primary: Accent color for selected tile, avatar initials background, branch tile border
   * @prop --dwc-color-primary-text: Text color on primary-colored surfaces (avatar initials)
   * @prop --dwc-color-primary-surface: Light primary surface for branch badge background
   * @prop --dwc-color-warning: Warning color for highlighted tile border
   * @prop --dwc-color-danger: Danger color for countdown ring and delete drop zone
   * @prop --dwc-border-radius: Border radius for user tiles and drop zones
   * @prop --dwc-border-radius-sm: Small border radius for branch badge
   * @prop --dwc-border-radius-full: Full (circular) border radius for user avatars
   * @prop --dwc-border-radius-lg: Large border radius for the floating drop zones container
   * @prop --dwc-shadow-sm: Small box shadow on resting user tiles
   * @prop --dwc-shadow-md: Medium box shadow on hovered user tiles
   * @prop --dwc-shadow-xl: Extra-large box shadow on the floating drop zones container
   * @prop --dwc-transition-fast: Fast transition duration for hover and drag states
   * @prop --dwc-spacing-xs: Extra-small spacing (4px default)
   * @prop --dwc-spacing-sm: Small spacing (8px default)
   * @prop --dwc-spacing-md: Medium spacing for tile padding and container padding (12px default)
   * @prop --dwc-spacing-lg: Large spacing for drop zone gaps (16px default)
   * @prop --dwc-spacing-xl: Extra-large spacing for children indentation (32px default)
   * @prop --dwc-spacing-2xl: Double extra-large spacing for empty-state padding
   */
  display: block;
  font-family: var(--dwc-font-family, system-ui, sans-serif);
  font-size: var(--dwc-font-size-base, 14px);
  line-height: var(--dwc-line-height-normal, 1.5);
  overflow: auto;
  position: relative;
}

/* === No Data Message === */

.no-data {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--dwc-spacing-2xl, 48px);
  color: var(--dwc-color-text-secondary, #666666);
  font-size: var(--dwc-font-size-lg, 16px);
  text-align: center;
}

/* === Tree Container === */

/* Tree renders as a vertical list. Each node is a row. */
.tree-container {
  display: flex;
  flex-direction: column;
  padding: var(--dwc-spacing-md, 12px);
}

/* === Tree Structure === */

/* Each tree node is a vertical stack: tile + children */
.tree-node {
  display: flex;
  flex-direction: column;
  position: relative;
}

/* Children are indented with left margin and border connectors */
.tree-children {
  display: flex;
  flex-direction: column;
  margin-left: var(--dwc-spacing-xl, 32px);
  padding-left: var(--dwc-spacing-md, 12px);
  border-left: 2px solid var(--dwc-color-border, #e0e0e0);
}

/* Horizontal connector from vertical line to each child tile */
.tree-children > .tree-node::before {
  content: '';
  position: absolute;
  top: calc(var(--dwc-spacing-sm, 8px) + 20px);
  left: calc(-1 * var(--dwc-spacing-md, 12px));
  width: var(--dwc-spacing-md, 12px);
  height: 2px;
  background: var(--dwc-color-border, #e0e0e0);
}

/* === User Tile === */

.user-tile {
  display: flex;
  flex-direction: row; /* Horizontal: avatar left, info right */
  align-items: center;
  padding: var(--dwc-spacing-sm, 8px) var(--dwc-spacing-md, 12px);
  margin: var(--dwc-spacing-xs, 4px) 0;
  background: var(--dwc-color-surface, #ffffff);
  border: 1px solid var(--dwc-color-border, #e0e0e0);
  border-radius: var(--dwc-border-radius, 6px);
  box-shadow: var(--dwc-shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.05));
  cursor: pointer;
  transition: box-shadow var(--dwc-transition-fast, 150ms) ease,
    border-color var(--dwc-transition-fast, 150ms) ease;
  position: relative;
  user-select: none;
  gap: var(--dwc-spacing-sm, 8px);
}

.user-tile:hover {
  box-shadow: var(--dwc-shadow-md, 0 2px 6px rgba(0, 0, 0, 0.1));
}

.user-tile.selected {
  border: 2px solid var(--dwc-color-primary, #0066cc);
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
}

.user-tile.highlighted {
  border: 2px solid var(--dwc-color-warning, #ffc107);
  background: rgba(255, 193, 7, 0.05);
}

.user-tile.dimmed {
  opacity: 0.3;
  pointer-events: none;
}

.user-tile.drag-over {
  border: 2px dashed var(--dwc-color-primary, #0066cc);
  background: rgba(0, 102, 204, 0.05);
  transform: scale(1.01);
}

.user-tile[draggable='true'] {
  cursor: grab;
}

.user-tile[draggable='true']:active {
  cursor: grabbing;
}

/* === Branch Tile === */

.branch-tile {
  background: var(--dwc-color-surface-alt, #f8f9fa);
  border-color: var(--dwc-color-primary, #0066cc);
  border-left: 3px solid var(--dwc-color-primary, #0066cc);
}

/* === User Avatar === */

.user-avatar {
  width: 40px;
  height: 40px;
  min-width: 40px;
  border-radius: var(--dwc-border-radius-full, 50%);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--dwc-color-primary, #0066cc);
}

/* Branch entities get square avatar */
.branch-avatar {
  border-radius: var(--dwc-border-radius, 6px);
}

.avatar-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.avatar-initials {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--dwc-color-primary, #0066cc);
  color: var(--dwc-color-primary-text, #ffffff);
  font-size: var(--dwc-font-size-sm, 12px);
  font-weight: var(--dwc-font-weight-semibold, 600);
}

/* === User Info === */

.user-info {
  display: flex;
  flex-direction: column;
  min-width: 0; /* Allow text truncation */
  flex: 1;
}

.user-name {
  font-weight: var(--dwc-font-weight-semibold, 600);
  color: var(--dwc-color-text, #1a1a1a);
  font-size: var(--dwc-font-size-base, 14px);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.user-role {
  color: var(--dwc-color-text-secondary, #666666);
  font-size: var(--dwc-font-size-sm, 12px);
}

.user-email,
.user-phone {
  color: var(--dwc-color-text-secondary, #666666);
  font-size: var(--dwc-font-size-sm, 12px);
}

.user-branch-badge {
  display: inline-block;
  padding: 1px 6px;
  margin-top: 2px;
  font-size: var(--dwc-font-size-xs, 11px);
  background: var(--dwc-color-primary-surface, rgba(0, 102, 204, 0.08));
  color: var(--dwc-color-primary, #0066cc);
  border-radius: var(--dwc-border-radius-sm, 3px);
  font-weight: var(--dwc-font-weight-medium, 500);
  white-space: nowrap;
}

/* === Long-Press Countdown Ring === */

.countdown-ring {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  pointer-events: none;
  z-index: 10;
}

.countdown-ring__circle {
  transform: rotate(-90deg);
  transform-origin: 50% 50%;
  transition: stroke-dashoffset 16ms linear;
}

/* === Drop Zones === */

.drop-zones {
  position: fixed;
  bottom: var(--dwc-spacing-xl, 32px);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: var(--dwc-spacing-lg, 16px);
  z-index: 100;
  padding: var(--dwc-spacing-md, 12px);
  background: var(--dwc-color-surface, #ffffff);
  border-radius: var(--dwc-border-radius-lg, 12px);
  box-shadow: var(--dwc-shadow-xl, 0 8px 24px rgba(0, 0, 0, 0.15));
}

.drop-zone {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: var(--dwc-spacing-sm, 8px);
  min-width: 120px;
  padding: var(--dwc-spacing-lg, 16px);
  border: 2px dashed var(--dwc-color-border, #e0e0e0);
  border-radius: var(--dwc-border-radius, 6px);
  background: var(--dwc-color-surface, #ffffff);
  cursor: pointer;
  transition: all var(--dwc-transition-fast, 150ms) ease;
}

.drop-zone:hover {
  border-color: var(--dwc-color-primary, #0066cc);
  background: rgba(0, 102, 204, 0.05);
  transform: scale(1.05);
}

.drop-zone--delete:hover {
  border-color: var(--dwc-color-danger, #dc3545);
  background: rgba(220, 53, 69, 0.05);
}

.drop-zone__icon {
  font-size: var(--dwc-font-size-xl, 20px);
}

.drop-zone__label {
  font-size: var(--dwc-font-size-sm, 12px);
  font-weight: var(--dwc-font-weight-medium, 500);
  color: var(--dwc-color-text, #1a1a1a);
}

/* === Theme Overrides === */

:host(.theme-light) {
  color: #1a1a1a;
}

:host(.theme-light) .no-data {
  color: #666666;
}

:host(.theme-light) .user-tile {
  background: #ffffff;
  border-color: #e0e0e0;
}

:host(.theme-light) .user-tile.selected {
  border-color: #0066cc;
  box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.2);
}

:host(.theme-light) .user-tile.highlighted {
  border-color: #ffc107;
  background: rgba(255, 193, 7, 0.05);
}

:host(.theme-light) .branch-tile {
  background: #f8f9fa;
  border-color: #0066cc;
}

:host(.theme-light) .tree-children {
  border-left-color: #e0e0e0;
}

:host(.theme-light) .tree-children > .tree-node::before {
  background: #e0e0e0;
}

:host(.theme-light) .avatar-initials {
  background: #0066cc;
  color: #ffffff;
}

:host(.theme-light) .user-name {
  color: #1a1a1a;
}

:host(.theme-light) .user-role,
:host(.theme-light) .user-email,
:host(.theme-light) .user-phone {
  color: #666666;
}

:host(.theme-light) .user-branch-badge {
  background: rgba(0, 102, 204, 0.08);
  color: #0066cc;
}

:host(.theme-light) .drop-zones {
  background: #ffffff;
}

:host(.theme-light) .drop-zone {
  background: #ffffff;
  border-color: #e0e0e0;
}

:host(.theme-light) .drop-zone:hover {
  border-color: #0066cc;
  background: rgba(0, 102, 204, 0.05);
}

:host(.theme-light) .drop-zone--delete:hover {
  border-color: #dc3545;
  background: rgba(220, 53, 69, 0.05);
}

:host(.theme-light) .drop-zone__label {
  color: #1a1a1a;
}

:host(.theme-dark) {
  color: #e0e0e0;
}

:host(.theme-dark) .no-data {
  color: #b0b0c0;
}

:host(.theme-dark) .user-tile {
  background: #2a2a3a;
  border-color: #3a3a4a;
}

:host(.theme-dark) .user-tile.selected {
  border-color: #4da6ff;
  box-shadow: 0 0 0 3px rgba(77, 166, 255, 0.3);
}

:host(.theme-dark) .user-tile.highlighted {
  border-color: #ffc107;
  background: rgba(255, 193, 7, 0.1);
}

:host(.theme-dark) .branch-tile {
  background: #1e2235;
  border-color: #4da6ff;
}

:host(.theme-dark) .tree-children {
  border-left-color: #3a3a4a;
}

:host(.theme-dark) .tree-children > .tree-node::before {
  background: #3a3a4a;
}

:host(.theme-dark) .avatar-initials {
  background: #4da6ff;
  color: #1a1a1a;
}

:host(.theme-dark) .user-name {
  color: #e0e0e0;
}

:host(.theme-dark) .user-role,
:host(.theme-dark) .user-email,
:host(.theme-dark) .user-phone {
  color: #b0b0c0;
}

:host(.theme-dark) .user-branch-badge {
  background: rgba(77, 166, 255, 0.12);
  color: #4da6ff;
}

:host(.theme-dark) .drop-zones {
  background: #2a2a3a;
}

:host(.theme-dark) .drop-zone {
  background: #2a2a3a;
  border-color: #3a3a4a;
}

:host(.theme-dark) .drop-zone:hover {
  border-color: #4da6ff;
  background: rgba(77, 166, 255, 0.1);
}

:host(.theme-dark) .drop-zone--delete:hover {
  border-color: #ff6b6b;
  background: rgba(255, 107, 107, 0.1);
}

:host(.theme-dark) .drop-zone__label {
  color: #e0e0e0;
}
